<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Ch√∫c em ng√†y 20/10</title>
  <link href="https://fonts.googleapis.com/css2?family=Mali:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      margin: 0; padding: 0; background: linear-gradient(135deg, #fffafa);
      overflow: hidden; font-family: "Mali", cursive; height: 100vh; position: relative;
    }
    .center-message {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,240,245,0.9));
      padding: 40px 50px; border-radius: 30px; font-size: 1.6rem; font-weight: 400; color: #c2185b; text-align: center;
      box-shadow: 0 20px 60px rgba(216,27,96,0.3), 0 0 0 1px rgba(255,255,255,0.5) inset;
      z-index: 1; max-width: 90%; animation: pulse 3s ease-in-out infinite; backdrop-filter: blur(10px);
      border: 2px solid rgba(255,255,255,0.3);
    }
    @keyframes pulse { 0%,100%{transform: translate(-50%, -50%) scale(1);} 50%{transform: translate(-50%, -50%) scale(1.05);} }
    .center-message strong{
      display:block; font-size:2rem; margin-bottom:15px; font-weight:700;
      background: linear-gradient(45deg,#d81b60,#f06292,#d81b60); background-size:200% auto;
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; animation: gradient 3s ease infinite;
    }
    @keyframes gradient { 0%,100%{background-position:0% 50%;} 50%{background-position:100% 50%;} }

    .overlay {
      position: fixed; top:0; left:0; width:100vw; height:100vh;
      background: rgba(0,0,0,0.5); backdrop-filter: blur(5px);
      z-index: 99; display:none; animation: fadeInOverlay 0.3s ease;
    }
    @keyframes fadeInOverlay { from{opacity:0;} to{opacity:1;} }
    .overlay.active { display:block; }

    .popup{
      position: fixed; top:50%; left:50%; transform: translate(-50%, -50%) scale(0.8);
      background: linear-gradient(135deg,#ffffff 0%,#fff5f8 100%); border-radius:25px;
      box-shadow: 0 25px 80px rgba(216,27,96,0.4); padding:30px; text-align:center; z-index:100;
      width:90%; max-width:400px; display:none; animation: popupShow .5s cubic-bezier(.68,-.55,.265,1.55) forwards;
      border:3px solid rgba(255,255,255,.8);
    }
    @keyframes popupShow {
      from { opacity:0; transform: translate(-50%, -50%) scale(.5) rotate(-5deg); }
      to   { opacity:1; transform: translate(-50%, -50%) scale(1)  rotate(0deg); }
    }
    .popup-content{ margin-top:20px; }
    .popup img{ max-width:100%; border-radius:15px; margin-bottom:20px; box-shadow:0 10px 30px rgba(0,0,0,.2); border:3px solid #fff; }
    .popup p{ font-size:1.1rem; color:#d81b60; line-height:1.6; margin-bottom:0; font-weight:500; }

    .falling-letter{
      position:absolute; top:-100px; width:50px; height:auto; animation: fall linear;
      cursor:pointer; user-select:none; z-index:2; animation-duration:8s;
      filter: drop-shadow(0 5px 10px rgba(0,0,0,.2)); transition: transform .3s ease;
    }
    .falling-letter:hover{ transform: scale(1.2) rotate(10deg); filter: drop-shadow(0 10px 20px rgba(216,27,96,.4)); }
    @keyframes fall{
      0%{ transform: translateY(0) translateX(0) rotate(0deg); opacity:1; }
      20%{ transform: translateY(20vh) translateX(-20px) rotate(-10deg); }
      40%{ transform: translateY(40vh) translateX(15px) rotate(8deg); }
      60%{ transform: translateY(60vh) translateX(-15px) rotate(-6deg); }
      80%{ transform: translateY(80vh) translateX(10px) rotate(4deg); }
      100%{ transform: translateY(100vh) translateX(0) rotate(0deg); opacity:.3; }
    }
    @keyframes letterClick{
      0%{ transform: scale(1) rotate(0deg); }
      50%{ transform: scale(1.3) rotate(360deg); }
      100%{ transform: scale(0) rotate(720deg); }
    }
    .letter-clicked{ animation: letterClick .6s ease-out forwards !important; }

    .heart{ position:absolute; transform: translate(-50%,-50%); animation: explode 2s ease-out forwards; pointer-events:none; user-select:none; }
    @keyframes explode{
      0%{ transform: translate(-50%,-50%) translate(0,0); opacity:1; }
      100%{ transform: translate(-50%,-50%) translate(var(--dx), var(--dy)) scale(1.5); opacity:0; }
    }

    .center-gif{ position: fixed; bottom:20px; left:50%; transform: translateX(-50%); width:150px; max-width:40vw; z-index:10; pointer-events:none; }

    @media (max-width: 768px){
      .center-message{ width: calc(100% - 20px); max-width:none; padding:20px 15px; font-size:1.1rem; border-radius:20px; left:50%; transform: translate(-50%, -50%); }
      .center-message strong{ font-size:1.3rem; margin-bottom:10px; }
      .popup{ width:90%; padding:20px; border-radius:20px; }
      .popup img{ border-radius:10px; margin-bottom:15px; }
      .popup p{ font-size:1rem; line-height:1.5; }
      .falling-letter{ width:40px; animation-duration:9s; }
      .heart{ font-size:18px !important; }
      .falling-letter::before{ content:''; position:absolute; top:-10px; left:-10px; right:-10px; bottom:-10px; }
    }
  </style>
</head>

<body>
  <!-- Th√¥ng ƒëi·ªáp ch√∫c m·ª´ng -->
  <div class="center-message">
    <strong>Ch√∫c em ng√†y 20-10</strong>
    <span id="centerText">
      Ng√†y Ph·ª• n·ªØ Vi·ªát Nam<br/>Mong em m√£i lu√¥n r·∫°ng r·ª° nh∆∞ nh·ªØng b√≥ hoa!
    </span>
  </div>

  <!-- ·∫¢nh ƒë·ªông trang tr√≠ -->
  <img src="./assets/mewmew.gif" alt="GIF" class="center-gif" />

  <!-- Hi·ªÉn th·ªã l·ªùi ch√∫c -->
  <div class="popup" id="popup">
    <div class="popup-content">
      <img id="popupImage" src="" alt="L·ªùi ch√∫c">
      <p id="popupMessage">L·ªùi ch√∫c ·ªü ƒë√¢y</p>
    </div>
  </div>
  <div class="overlay" id="overlay"></div>

  <!-- Nh·∫°c n·ªÅn -->
  <audio id="player" src="./assets/Lovein1.mp3"></audio>

  <script>
    // ====== D·ªÆ LI·ªÜU L·ªúI CH√öC ======
    const messages = [
      { img: "./assets/a1.jpg", text: "Ch√∫c b√© y√™u c·ªßa anh lu√¥n vui v·∫ª, xinh ƒë·∫πp v√† ng·∫≠p tr√†n y√™u th∆∞∆°ng!üíó" },
      { img: "./assets/a2.jpg", text: "M·ªói khi em c∆∞·ªùi, anh th·∫•y c·∫£ b·∫ßu tr·ªùi c≈©ng ph·∫£i ghen t·ªã v√¨ ch·∫≥ng ai r·ª±c r·ª° h∆°n em." },
     { img: "./assets/a4.jpg", text: "Ch√∫c em m·ªôt ng√†y 20/10 th·∫≠t h·∫°nh ph√∫c v√† tr·ªçn v·∫πn!" },
      { img: "./assets/a3.jpg", text: "C·∫£m ∆°n em ƒë√£ ƒë·∫øn b√™n anh v√† ƒë√£ lu√¥n m·∫°nh m·∫Ω v√† tuy·ªát v·ªùi nh∆∞ th·∫ø!" },

      { img: "./assets/a5.jpg", text: "Em l√† m√≥n qu√† tuy·ªát v·ªùi nh·∫•t m√† cu·ªôc s·ªëng mang l·∫°i!" }
    ];
    let currentMessageIndex = 0;

    // ====== ELEMENTS ======
    const popup = document.getElementById("popup");
    const overlay = document.getElementById("overlay");
    const popupImage = document.getElementById("popupImage");
    const popupMessage = document.getElementById("popupMessage");
    const centerText = document.getElementById("centerText");
    const player = document.getElementById("player");

    // L∆∞u l·∫°i n·ªôi dung gi·ªØa m√†n h√¨nh ban ƒë·∫ßu ƒë·ªÉ "reset v·ªÅ trang ch·ªß"
    const initialCenterHTML = centerText.innerHTML;

    // ====== ICON R∆†I ======
    const letterImages = [
      "./assets/letters.png", "./assets/q3.png", "./assets/h1.png",
      "./assets/h3.png", "./assets/t2.png", "./assets/t5.png", "./assets/q1.png","./assets/q6.png",
    ];

    function createHeartExplosion(x, y) {
      const hearts = ['üíó'];
      const numHearts = 12;
      for (let i = 0; i < numHearts; i++) {
        const heart = document.createElement('div');
        heart.classList.add('heart');
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        const angle = (Math.PI * 2 / numHearts) * i;
        const distance = Math.random() * 80 + 40;
        heart.style.left = x + 'px';
        heart.style.top = y + 'px';
        heart.style.setProperty('--dx', Math.cos(angle) * distance + 'px');
        heart.style.setProperty('--dy', Math.sin(angle) * distance + 'px');
        heart.style.fontSize = (Math.random() * 10 + 20) + 'px';
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 2000);
      }
    }

    function createFallingLetter() {
      const letter = document.createElement("img");
      const randomImage = letterImages[Math.floor(Math.random() * letterImages.length)];
      letter.src = randomImage;
      letter.classList.add("falling-letter");
      letter.style.left = Math.random() * (window.innerWidth - 50) + "px";

      // Click v√†o icon r∆°i: bung tim + chuy·ªÉn l·ªùi ch√∫c
      letter.addEventListener("click", (e) => {
        e.stopPropagation(); // ch·∫∑n lan l√™n body (tr√°nh double trigger)
        createHeartExplosion(e.clientX, e.clientY);
        letter.classList.add('letter-clicked');
        setTimeout(() => {
          nextMessage();
        }, 280);
      });

      document.body.appendChild(letter);
      setTimeout(() => letter.remove(), 8000);
    }

    // ƒê∆∞a giao di·ªán v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu
    function resetToHome() {
      popup.style.display = "none";
      overlay.classList.remove("active");
      centerText.innerHTML = initialCenterHTML;
      currentMessageIndex = 0; // b·∫Øt ƒë·∫ßu l·∫°i t·ª´ ƒë·∫ßu
    }

    // Hi·ªÉn th·ªã l·ªùi ch√∫c k·∫ø ti·∫øp (ƒë·∫øn h·∫øt th√¨ tho√°t v·ªÅ m√†n h√¨nh ch√≠nh)
    function nextMessage() {
      // N·∫øu ƒë√£ xem h·∫øt -> reset & tho√°t
      if (currentMessageIndex >= messages.length) {
        resetToHome();
        return;
      }

      const message = messages[currentMessageIndex];
      popupImage.src = message.img;
      popupMessage.textContent = message.text;

      // M·ªü popup & overlay n·∫øu ƒëang ·∫©n
      if (popup.style.display !== "block") {
        popup.style.display = "block";
        overlay.classList.add("active");
      }

      // L∆∞u l·∫°i l·ªùi hi·ªán t·∫°i ƒë·ªÉ d√πng khi c·∫ßn (kh√¥ng b·∫Øt bu·ªôc n·ªØa v√¨ ƒë√£ c√≥ resetToHome)
      popup.dataset.currentMessage = message.text;

      // Chuy·ªÉn index cho l·∫ßn sau
      currentMessageIndex++;
    }

    // ƒê√≥ng popup th·ªß c√¥ng (Esc) -> c≈©ng coi nh∆∞ v·ªÅ trang ch·ªß
    function closePopup() {
      resetToHome();
    }

    // To√†n m√†n h√¨nh: m·ªói click/tap -> ph√°t nh·∫°c (n·∫øu ch∆∞a) + hi·ªán l·ªùi ch√∫c k·∫ø ti·∫øp
    document.addEventListener("click", function (e) {
      // B·ªè qua n·∫øu click b√™n trong popup ho·∫∑c click v√†o icon r∆°i (ƒë√£ x·ª≠ l√Ω ri√™ng)
      if (e.target.closest(".popup") || e.target.classList.contains("falling-letter")) return;

      if (player.paused) { player.play().catch(()=>{}); }
      nextMessage();
    }, { passive: true });

    // Click overlay: chuy·ªÉn l·ªùi ch√∫c k·∫ø ti·∫øp
    overlay.addEventListener("click", function (e) {
      e.stopPropagation();
      nextMessage();
    });

    // Esc ƒë·ªÉ ƒë√≥ng v√† v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closePopup();
    });

    // T·∫°o icon r∆°i li√™n t·ª•c
    setInterval(createFallingLetter, 1000);
  </script>
</body>
</html>
